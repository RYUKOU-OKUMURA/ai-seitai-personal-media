---
import Layout from '../layouts/Layout.astro';
import AppRoot from '../components/core/AppRoot';
import { getCollection } from 'astro:content';

const events = (await getCollection('events', ({ data }) => !data.draft)).map((event) => ({
	slug: event.slug,
	title: event.data.title,
	dateLabel: event.data.dateLabel,
	image: event.data.image,
	tag: event.data.tag,
	link: event.data.link,
}));

const posts = (await getCollection('blog', ({ data }) => !data.draft))
	.sort((a, b) => (a.data.publishedAt < b.data.publishedAt ? 1 : -1))
	.map((post) => ({
		slug: post.slug,
		title: post.data.title,
		publishedAt: post.data.publishedAt,
		category: post.data.category,
		image: post.data.image,
		excerpt: post.data.excerpt,
	}));
---

<Layout title="整体院のAI仕組み化支援">
	<AppRoot client:only="react" events={events} posts={posts} />
</Layout>
